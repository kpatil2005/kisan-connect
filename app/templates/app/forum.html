{% extends 'app/base.html' %}
{% load static %}

{% block title %}Farmer Community{% endblock %}

{% block main-content %}
<div class="community-platform">
    <!-- Header Section -->
    <div class="platform-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <div class="header-content">
                        <h1 class="platform-title">Farmer Community Network</h1>
                        <p class="platform-subtitle">Connect • Collaborate • Cultivate Success</p>
                        <div class="stats-row">
                            <div class="stat-item">
                                <span class="stat-number">{{ groups|length }}</span>
                                <span class="stat-label">Active Communities</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">50+</span>
                                <span class="stat-label">States Covered</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">1000+</span>
                                <span class="stat-label">Farmers Connected</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 text-end">
                    <button class="btn btn-primary btn-add-community" data-bs-toggle="modal" data-bs-target="#addGroupModal">
                        <i class="fas fa-plus"></i>
                        Add Your Community
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Filters and Search -->
    <div class="filters-section">
        <div class="container">
            <div class="filters-container">
                <div class="row align-items-center">
                    <div class="col-lg-3 col-md-6 mb-3 mb-lg-0">
                        <div class="search-box">
                            <input type="text" id="searchCommunities" class="form-control" placeholder="Search communities...">
                            <i class="fas fa-search search-icon"></i>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-3 mb-lg-0">
                        <select id="filterState" class="form-select filter-select">
                            <option value="">All States</option>
                            {% regroup groups by state as state_groups %}
                            {% for state_group in state_groups %}
                                <option value="{{ state_group.grouper }}">{{ state_group.grouper }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-3 mb-lg-0">
                        <select id="filterPlatform" class="form-select filter-select">
                            <option value="">All Platforms</option>
                            {% regroup groups by platform as platform_groups %}
                            {% for platform_group in platform_groups %}
                                <option value="{{ platform_group.grouper }}">{{ platform_group.list.0.get_platform_display }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-lg-2 col-md-6 mb-3 mb-lg-0">
                        <select id="sortBy" class="form-select filter-select">
                            <option value="name">Sort by Name</option>
                            <option value="state">Sort by State</option>
                            <option value="platform">Sort by Platform</option>
                        </select>
                    </div>
                    <div class="col-lg-3 text-lg-end">
                        <div class="view-toggles">
                            <button class="view-toggle active" data-view="grid" title="Grid View">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button class="view-toggle" data-view="list" title="List View">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Communities Section -->
    <div class="communities-section">
        <div class="container">
            <div id="communitiesContainer" class="communities-grid">
                {% for group in groups %}
                <div class="community-card" 
                     data-state="{{ group.state }}" 
                     data-district="{{ group.district }}"
                     data-platform="{{ group.platform }}"
                     data-name="{{ group.group_name|lower }}">
                    <div class="card-header">
                        <div class="community-icon">
                            {% if group.platform == 'whatsapp' %}
                                <i class="fab fa-whatsapp"></i>
                            {% elif group.platform == 'telegram' %}
                                <i class="fab fa-telegram"></i>
                            {% elif group.platform == 'facebook' %}
                                <i class="fab fa-facebook"></i>
                            {% else %}
                                <i class="fas fa-users"></i>
                            {% endif %}
                        </div>
                        <div class="platform-badge">{{ group.get_platform_display }}</div>
                    </div>
                    <div class="card-content">
                        <h3 class="community-name">{{ group.group_name }}</h3>
                        <div class="location-info">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ group.state }}, {{ group.district }}</span>
                            {% if group.region %}
                                <small>({{ group.region }})</small>
                            {% endif %}
                        </div>
                        {% if group.description %}
                            <p class="community-description">{{ group.description|truncatewords:15 }}</p>
                        {% endif %}
                    </div>
                    <div class="card-footer">
                        <a href="{{ group.group_link }}" target="_blank" class="btn btn-join">
                            <i class="fas fa-external-link-alt"></i>
                            Join Community
                        </a>
                        <button class="btn btn-secondary btn-info" data-bs-toggle="tooltip" title="More Info">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                </div>
                {% empty %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-seedling"></i>
                    </div>
                    <h3>No Communities Yet</h3>
                    <p>Be the first to plant the seed of community connection!</p>
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addGroupModal">
                        Add First Community
                    </button>
                </div>
                {% endfor %}
            </div>
            
            <!-- No Results -->
            <div id="noResults" class="empty-state" style="display: none;">
                <div class="empty-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>No Communities Found</h3>
                <p>Try adjusting your filters or search terms</p>
            </div>
        </div>
    </div>

    <!-- Enhanced Modal -->
    <div class="modal fade" id="addGroupModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <h5 class="modal-title">Add New Community</h5>
                        <p class="modal-subtitle">Help grow the farming community network</p>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                
                <form id="add-group-form" method="post" action="{% url 'app:add_group' %}">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="form-progress">
                            <div class="progress-bar">
                                <div class="progress-fill"></div>
                            </div>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="id_group_name" class="form-label">
                                    <i class="fas fa-users"></i>
                                    Community Name *
                                </label>
                                {{ form.group_name }}
                                <div class="field-hint">Choose a descriptive name for your farming community</div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="id_state" class="form-label">
                                        <i class="fas fa-map"></i>
                                        State *
                                    </label>
                                    {{ form.state }}
                                </div>
                                <div class="form-group">
                                    <label for="id_district" class="form-label">
                                        <i class="fas fa-map-marker-alt"></i>
                                        District *
                                    </label>
                                    {{ form.district }}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="id_region" class="form-label">
                                    <i class="fas fa-location-dot"></i>
                                    Region/Area
                                </label>
                                {{ form.region }}
                                <div class="field-hint">Optional: Specify particular area or tehsil</div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="id_platform" class="form-label">
                                        <i class="fas fa-comments"></i>
                                        Platform *
                                    </label>
                                    {{ form.platform }}
                                </div>
                                <div class="form-group">
                                    <label for="id_group_link" class="form-label">
                                        <i class="fas fa-link"></i>
                                        Community Link *
                                    </label>
                                    {{ form.group_link }}
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="id_description" class="form-label">
                                    <i class="fas fa-align-left"></i>
                                    Description
                                </label>
                                {{ form.description }}
                                <div class="field-hint">Brief description of your community's focus and activities</div>
                            </div>
                        </div>
                        
                        <div id="form-message"></div>
                        
                        <div class="submission-note">
                            <i class="fas fa-shield-alt"></i>
                            <div>
                                <strong>Quality Assurance:</strong>
                                <span>Your community will be reviewed for authenticity and relevance before being published.</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="add-group-btn">
                            <span>Submit Community</span>
                            <span id="loading-spinner" class="spinner-border spinner-border-sm" role="status" style="display:none;"></span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
:root {
    --primary-color: #2E7D32;
    --secondary-color: #4CAF50;
    --accent-color: #FF6F00;
    --success-color: #388E3C;
    --background-color: #F8F9FA;
    --card-bg: #FFFFFF;
    --text-primary: #1B1B1B;
    --text-secondary: #666666;
    --border-color: #E0E0E0;
    --shadow-light: 0 2px 8px rgba(0,0,0,0.1);
    --shadow-medium: 0 4px 16px rgba(0,0,0,0.12);
    --shadow-heavy: 0 8px 32px rgba(0,0,0,0.15);
}

.community-platform {
    min-height: 100vh;
    background: linear-gradient(135deg, #f8f9fa 0%, #e8f5e8 100%);
}

/* Header Section */
.platform-header {
    background: linear-gradient(135deg, #1a472a 0%, #2d5a2d 20%, var(--primary-color) 40%, var(--secondary-color) 80%, #66bb6a 100%);
    color: white;
    padding: 4rem 0;
    position: relative;
    overflow: hidden;
}

.platform-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 50%, rgba(255,255,255,0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(255,193,7,0.2) 0%, transparent 50%),
        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="50" height="50" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="20" r="0.8" fill="rgba(255,255,255,0.05)"/><circle cx="20" cy="40" r="0.6" fill="rgba(255,255,255,0.08)"/><path d="M5,15 Q10,10 15,15 T25,15" stroke="rgba(255,255,255,0.03)" fill="none"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    animation: headerFloat 20s ease-in-out infinite;
}

.platform-header::after {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: 
        conic-gradient(from 0deg at 50% 50%, 
            rgba(255,255,255,0) 0deg,
            rgba(255,255,255,0.05) 60deg,
            rgba(255,255,255,0) 120deg,
            rgba(255,255,255,0.03) 180deg,
            rgba(255,255,255,0) 240deg,
            rgba(255,255,255,0.08) 300deg,
            rgba(255,255,255,0) 360deg);
    animation: headerRotate 30s linear infinite;
    pointer-events: none;
}

@keyframes headerFloat {
    0%, 100% { transform: translateY(0px) scale(1); }
    33% { transform: translateY(-10px) scale(1.02); }
    66% { transform: translateY(5px) scale(0.98); }
}

@keyframes headerRotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.platform-title {
    font-size: 3rem;
    font-weight: 800;
    margin-bottom: 0.5rem;
    text-shadow: 
        0 2px 4px rgba(0,0,0,0.3),
        0 0 20px rgba(255,255,255,0.1),
        0 0 40px rgba(255,193,7,0.2);
    background: linear-gradient(45deg, #fff, #ffeb3b, #fff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: titleGlow 3s ease-in-out infinite alternate;
    position: relative;
    z-index: 2;
}

@keyframes titleGlow {
    0% { filter: brightness(1) saturate(1); }
    100% { filter: brightness(1.1) saturate(1.2); }
}

.platform-subtitle {
    font-size: 1.3rem;
    opacity: 0.95;
    margin-bottom: 2.5rem;
    font-weight: 400;
    text-shadow: 0 1px 3px rgba(0,0,0,0.2);
    position: relative;
    z-index: 2;
}

.stats-row {
    display: flex;
    gap: 3rem;
    flex-wrap: wrap;
    position: relative;
    z-index: 2;
}

.stat-item {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    padding: 1rem 1.5rem;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.2);
    transition: all 0.3s ease;
    animation: statFloat 4s ease-in-out infinite;
}

.stat-item:nth-child(2) { animation-delay: -1.3s; }
.stat-item:nth-child(3) { animation-delay: -2.6s; }

.stat-item:hover {
    transform: translateY(-5px) scale(1.05);
    background: rgba(255,255,255,0.15);
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

@keyframes statFloat {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-8px); }
}

.stat-number {
    font-size: 2.2rem;
    font-weight: 800;
    background: linear-gradient(45deg, var(--accent-color), #ffb74d, #ffc107);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
}

.btn-add-community {
    background: linear-gradient(45deg, var(--accent-color), #ff8a65, #ff7043);
    border: none;
    padding: 15px 30px;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1.1rem;
    box-shadow: 
        0 8px 25px rgba(255, 111, 0, 0.4),
        0 0 20px rgba(255, 111, 0, 0.2),
        inset 0 1px 0 rgba(255,255,255,0.3);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    z-index: 2;
    overflow: hidden;
}

.btn-add-community::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
    transition: left 0.5s;
}

.btn-add-community:hover {
    background: linear-gradient(45deg, #FF8F00, #ff7043, #ff5722);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 
        0 15px 35px rgba(255, 111, 0, 0.5),
        0 0 30px rgba(255, 111, 0, 0.3),
        inset 0 1px 0 rgba(255,255,255,0.4);
    color: white;
}

.btn-add-community:hover::before {
    left: 100%;
}

.btn-add-community i {
    margin-right: 10px;
    animation: bounceIcon 2s ease-in-out infinite;
}

@keyframes bounceIcon {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0) rotate(0deg); }
    40% { transform: translateY(-3px) rotate(5deg); }
    60% { transform: translateY(-2px) rotate(-5deg); }
}

/* Filters Section */
.filters-section {
    background: white;
    padding: 1.5rem 0;
    border-bottom: 1px solid var(--border-color);
    box-shadow: var(--shadow-light);
}

.filters-container {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: var(--shadow-light);
}

.search-box {
    position: relative;
}

.search-box input {
    padding-left: 2.5rem;
    border-radius: 8px;
    border: 2px solid var(--border-color);
    transition: all 0.3s ease;
}

.search-box input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
}

.search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}

.filter-select {
    border-radius: 8px;
    border: 2px solid var(--border-color);
    transition: all 0.3s ease;
}

.filter-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
}

.view-toggles {
    display: flex;
    gap: 8px;
}

.view-toggle {
    background: var(--background-color);
    border: 2px solid var(--border-color);
    padding: 8px 12px;
    border-radius: 6px;
    color: var(--text-secondary);
    transition: all 0.3s ease;
}

.view-toggle.active,
.view-toggle:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* Communities Grid */
.communities-section {
    padding: 2rem 0;
}

.communities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 1.5rem;
}

.community-card {
    background: linear-gradient(145deg, #ffffff 0%, #fafafa 100%);
    border-radius: 20px;
    box-shadow: 
        0 10px 30px rgba(0,0,0,0.1),
        0 1px 8px rgba(0,0,0,0.06),
        inset 0 1px 0 rgba(255,255,255,0.8);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    overflow: hidden;
    border: 1px solid rgba(46, 125, 50, 0.1);
    position: relative;
}

.community-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, 
        var(--primary-color) 0%, 
        var(--secondary-color) 50%, 
        var(--accent-color) 100%);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.community-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 
        0 25px 50px rgba(0,0,0,0.15),
        0 10px 20px rgba(46, 125, 50, 0.1),
        inset 0 1px 0 rgba(255,255,255,0.9);
    border-color: rgba(46, 125, 50, 0.2);
}

.community-card:hover::before {
    opacity: 1;
}

.card-header {
    padding: 2rem;
    background: linear-gradient(135deg, 
        rgba(248,249,250,0.8) 0%, 
        rgba(232,245,232,0.9) 50%,
        rgba(248,249,250,0.8) 100%);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
}

.card-header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(46, 125, 50, 0.2) 50%, 
        transparent 100%);
}

.community-icon {
    width: 56px;
    height: 56px;
    border-radius: 16px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.8rem;
    box-shadow: 
        0 8px 16px rgba(46, 125, 50, 0.3),
        inset 0 1px 0 rgba(255,255,255,0.2);
    transition: all 0.3s ease;
    position: relative;
}

.community-icon::before {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    right: 2px;
    bottom: 2px;
    border-radius: 12px;
    background: linear-gradient(135deg, 
        rgba(255,255,255,0.2) 0%, 
        transparent 50%, 
        rgba(0,0,0,0.05) 100%);
    pointer-events: none;
}

.community-card:hover .community-icon {
    transform: rotate(5deg) scale(1.1);
    box-shadow: 
        0 12px 24px rgba(46, 125, 50, 0.4),
        inset 0 1px 0 rgba(255,255,255,0.3);
}

.platform-badge {
    background: linear-gradient(135deg, white 0%, #f8f9fa 100%);
    color: var(--primary-color);
    padding: 8px 16px;
    border-radius: 25px;
    font-size: 0.85rem;
    font-weight: 700;
    border: 2px solid var(--primary-color);
    box-shadow: 
        0 4px 12px rgba(46, 125, 50, 0.2),
        inset 0 1px 0 rgba(255,255,255,0.8);
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.community-card:hover .platform-badge {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    color: white;
    border-color: white;
    transform: scale(1.05);
}

.card-content {
    padding: 1.5rem;
}

.community-name {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.75rem;
    line-height: 1.3;
}

.location-info {
    display: flex;
    align-items: center;
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1rem;
    gap: 8px;
}

.location-info i {
    color: var(--primary-color);
}

.community-description {
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.5;
}

.card-footer {
    padding: 0 1.5rem 1.5rem;
    display: flex;
    gap: 12px;
}

.btn-join {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--success-color) 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    font-weight: 600;
    flex: 1;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 6px 20px rgba(46, 125, 50, 0.3),
        inset 0 1px 0 rgba(255,255,255,0.2);
}

.btn-join::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent, 
        rgba(255,255,255,0.4), 
        transparent);
    transition: left 0.5s;
}

.btn-join:hover {
    background: linear-gradient(135deg, var(--success-color) 0%, #2e7d32 100%);
    color: white;
    transform: translateY(-2px) scale(1.05);
    box-shadow: 
        0 10px 30px rgba(46, 125, 50, 0.4),
        inset 0 1px 0 rgba(255,255,255,0.3);
}

.btn-join:hover::before {
    left: 100%;
}

.btn-info {
    background: linear-gradient(135deg, var(--background-color) 0%, #e3f2fd 100%);
    color: var(--primary-color);
    border: 2px solid rgba(46, 125, 50, 0.2);
    padding: 12px 16px;
    border-radius: 25px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}

.btn-info:hover {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    color: white;
    border-color: var(--primary-color);
    transform: translateY(-2px) scale(1.1);
    box-shadow: 0 8px 20px rgba(46, 125, 50, 0.3);
}

/* List View */
.communities-grid.list-view {
    display: block;
}

.communities-grid.list-view .community-card {
    border-radius: 12px;
    margin-bottom: 1rem;
}

.communities-grid.list-view .card-header {
    padding: 1rem 1.5rem;
}

.communities-grid.list-view .card-content {
    padding: 1rem 1.5rem;
}

/* Empty State */
.empty-state {
    grid-column: 1 / -1;
    text-align: center;
    padding: 4rem 2rem;
}

.empty-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: var(--background-color);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
    color: var(--text-secondary);
    font-size: 2rem;
}

.empty-state h3 {
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.empty-state p {
    color: var(--text-secondary);
    margin-bottom: 1.5rem;
}

/* Enhanced Modal */
.modal-content {
    border: none;
    border-radius: 25px;
    box-shadow: 
        0 20px 60px rgba(0,0,0,0.15),
        0 10px 30px rgba(46, 125, 50, 0.1);
    overflow: hidden;
}

.modal-header {
    background: linear-gradient(135deg, 
        var(--primary-color) 0%, 
        var(--secondary-color) 50%, 
        #66bb6a 100%);
    color: white;
    border-radius: 25px 25px 0 0;
    padding: 2.5rem;
    position: relative;
}

.modal-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 20% 30%, rgba(255,255,255,0.2) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255,193,7,0.15) 0%, transparent 50%);
    pointer-events: none;
}

.modal-title-section {
    position: relative;
    z-index: 2;
}

.modal-title-section h5 {
    font-size: 1.8rem;
    font-weight: 800;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.modal-subtitle {
    opacity: 0.9;
    margin: 0;
    font-size: 1rem;
    font-weight: 400;
}

.btn-close {
    filter: invert(1);
    opacity: 0.8;
    transition: all 0.3s ease;
    position: relative;
    z-index: 3;
}

.btn-close:hover {
    opacity: 1;
    transform: scale(1.1);
}

.form-progress {
    margin-bottom: 2rem;
    position: relative;
}

.progress-bar {
    height: 6px;
    background: linear-gradient(90deg, #e9ecef 0%, #dee2e6 100%);
    border-radius: 10px;
    overflow: hidden;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, 
        var(--primary-color) 0%, 
        var(--secondary-color) 50%, 
        var(--accent-color) 100%);
    width: 0;
    transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    border-radius: 10px;
    position: relative;
    box-shadow: 0 0 10px rgba(46, 125, 50, 0.3);
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255,255,255,0.4) 50%, 
        transparent 100%);
    animation: progressShimmer 2s infinite;
}

@keyframes progressShimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(200%); }
}

.form-control, .form-select {
    border-radius: 12px;
    border: 2px solid #e9ecef;
    padding: 14px 16px;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
    box-shadow: 
        inset 0 2px 4px rgba(0,0,0,0.06),
        0 1px 0 rgba(255,255,255,0.8);
}

.form-control:focus, .form-select:focus {
    border-color: var(--primary-color);
    box-shadow: 
        0 0 0 4px rgba(46, 125, 50, 0.15),
        inset 0 2px 4px rgba(0,0,0,0.06),
        0 4px 12px rgba(46, 125, 50, 0.1);
    background: linear-gradient(145deg, #ffffff 0%, #f0f8f0 100%);
    transform: translateY(-1px);
}

.form-label {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.95rem;
}

.form-label i {
    color: var(--primary-color);
    font-size: 1.1rem;
    width: 18px;
    text-align: center;
}

.submission-note {
    background: linear-gradient(135deg, 
        rgba(227, 242, 253, 0.8) 0%, 
        rgba(232, 245, 232, 0.8) 100%);
    border: 2px solid rgba(46, 125, 50, 0.2);
    border-radius: 16px;
    padding: 1.5rem;
    margin-top: 2rem;
    display: flex;
    gap: 16px;
    align-items: flex-start;
    position: relative;
    backdrop-filter: blur(5px);
}

.submission-note::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, 
        var(--primary-color) 0%, 
        var(--secondary-color) 50%, 
        var(--accent-color) 100%);
    border-radius: 16px 16px 0 0;
}

.submission-note i {
    color: var(--primary-color);
    font-size: 1.4rem;
    margin-top: 2px;
    animation: noteIconPulse 2s ease-in-out infinite;
}

@keyframes noteIconPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Modal Footer Enhancement */
.modal-footer {
    padding: 1.5rem 2.5rem 2.5rem;
    border: none;
    background: linear-gradient(145deg, #fafafa 0%, #f0f0f0 100%);
}

.modal-footer .btn {
    padding: 12px 24px;
    border-radius: 25px;
    font-weight: 600;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
}

.modal-footer .btn-primary {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--success-color) 100%);
    border: none;
    box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
}

.modal-footer .btn-primary:hover {
    transform: translateY(-2px) scale(1.05);
    box-shadow: 0 10px 30px rgba(46, 125, 50, 0.4);
}rem;
}

.progress-bar {
    height: 4px;
    background: var(--border-color);
    border-radius: 2px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--primary-color);
    width: 0;
    transition: width 0.3s ease;
}

.form-grid {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-label {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.form-label i {
    color: var(--primary-color);
}

.form-control, .form-select {
    border-radius: 8px;
    border: 2px solid var(--border-color);
    padding: 12px;
    transition: all 0.3s ease;
}

.form-control:focus, .form-select:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
}

.field-hint {
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-top: 0.25rem;
}

.submission-note {
    background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e8 100%);
    border: 1px solid rgba(46, 125, 50, 0.2);
    border-radius: 8px;
    padding: 1rem;
    margin-top: 1.5rem;
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

.submission-note i {
    color: var(--primary-color);
    font-size: 1.2rem;
    margin-top: 2px;
}

/* Responsive Design */
@media (max-width: 768px) {
    .platform-title {
        font-size: 2rem;
    }
    
    .stats-row {
        gap: 1rem;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .communities-grid {
        grid-template-columns: 1fr;
    }
    
    .filters-container .row > div {
        margin-bottom: 1rem;
    }
}

/* Animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.community-card {
    animation: fadeInUp 0.3s ease-out;
}

/* Tooltips */
.tooltip {
    font-size: 0.8rem;
}
</style>

<!-- Additional JavaScript for new functionalities -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize tooltips
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });

    // Search functionality
    const searchInput = document.getElementById('searchCommunities');
    const stateFilter = document.getElementById('filterState');
    const platformFilter = document.getElementById('filterPlatform');
    const sortSelect = document.getElementById('sortBy');
    const viewToggles = document.querySelectorAll('.view-toggle');
    const communitiesContainer = document.getElementById('communitiesContainer');
    const noResults = document.getElementById('noResults');

    // Search and filter
    function filterCommunities() {
        const searchTerm = searchInput.value.toLowerCase();
        const stateValue = stateFilter.value;
        const platformValue = platformFilter.value;
        const cards = document.querySelectorAll('.community-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const name = card.dataset.name;
            const state = card.dataset.state;
            const platform = card.dataset.platform;

            const matchesSearch = name.includes(searchTerm) || 
                                state.toLowerCase().includes(searchTerm) ||
                                card.dataset.district.toLowerCase().includes(searchTerm);
            const matchesState = !stateValue || state === stateValue;
            const matchesPlatform = !platformValue || platform === platformValue;

            if (matchesSearch && matchesState && matchesPlatform) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        noResults.style.display = visibleCount === 0 ? 'block' : 'none';
    }

    // Sort functionality
    function sortCommunities() {
        const cards = Array.from(document.querySelectorAll('.community-card'));
        const sortBy = sortSelect.value;

        cards.sort((a, b) => {
            let aValue, bValue;
            switch(sortBy) {
                case 'name':
                    aValue = a.dataset.name;
                    bValue = b.dataset.name;
                    break;
                case 'state':
                    aValue = a.dataset.state;
                    bValue = b.dataset.state;
                    break;
                case 'platform':
                    aValue = a.dataset.platform;
                    bValue = b.dataset.platform;
                    break;
            }
            return aValue.localeCompare(bValue);
        });

        cards.forEach(card => communitiesContainer.appendChild(card));
    }

    // View toggle
    viewToggles.forEach(toggle => {
        toggle.addEventListener('click', () => {
            viewToggles.forEach(t => t.classList.remove('active'));
            toggle.classList.add('active');
            
            if (toggle.dataset.view === 'list') {
                communitiesContainer.classList.add('list-view');
            } else {
                communitiesContainer.classList.remove('list-view');
            }
        });
    });

    // Event listeners
    searchInput.addEventListener('input', filterCommunities);
    stateFilter.addEventListener('change', filterCommunities);
    platformFilter.addEventListener('change', filterCommunities);
    sortSelect.addEventListener('change', sortCommunities);

    // Form progress
    const formInputs = document.querySelectorAll('#add-group-form input, #add-group-form select, #add-group-form textarea');
    const progressFill = document.querySelector('.progress-fill');
    
    function updateProgress() {
        const totalFields = formInputs.length;
        const filledFields = Array.from(formInputs).filter(input => input.value.trim() !== '').length;
        const progress = (filledFields / totalFields) * 100;
        progressFill.style.width = progress + '%';
    }

    formInputs.forEach(input => {
        input.addEventListener('input', updateProgress);
    });
});
</script>
{% endblock %}

{% block custom_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const stateSelect = document.getElementById('id_state'); // Use Django's auto-generated ID
    const districtInput = document.getElementById('id_district'); // Use Django's auto-generated ID
    const addGroupForm = document.getElementById('add-group-form');
    const addGroupBtn = document.getElementById('add-group-btn');
    const formMessage = document.getElementById('form-message');
    const loadingSpinner = document.getElementById('loading-spinner');

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            document.cookie.split(';').forEach(cookie => {
                if (cookie.trim().startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.trim().substring(name.length + 1));
                }
            });

{% endblock custom_js %}            